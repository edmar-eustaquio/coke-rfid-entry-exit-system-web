import{j as e,r as s,a as U}from"./app-CVtOkzCn.js";import{u as X}from"./usePagination-BeXn-rk_.js";function b(){return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"30px",viewBox:"0 0 64 48",children:e.jsxs("g",{fill:"currentColor",children:[e.jsx("rect",{color:"red",x:"2",y:"14",width:"36",height:"18",rx:"2"}),e.jsx("path",{color:"orange",d:"M40 18h12a2 2 0 0 1 2 2v12H40z"}),e.jsx("circle",{color:"black",cx:"14",cy:"36",r:"6"}),e.jsx("circle",{color:"black",cx:"46",cy:"36",r:"6"})]})})}function G({LOCATIONS:N,logo:M,REFRESH_SECONDS_DURATION:S,LOGISTICS_UNITS:o}){const g=s.useRef(!1),[_,k]=s.useState([]),[z,w]=s.useState(1),[F,L]=s.useState(""),[n,C]=s.useState({trucks_total:[],trucks_overall_total:0,onsite_trucks_total:{},onsite_per_station:{},onsite_trucks_overall_total:0}),[m,P]=s.useState(""),[l,E]=s.useState(""),[i,p]=s.useState(""),[h,D]=s.useState(""),[u,R]=s.useState(""),[c,j]=s.useState(""),{page:f,size:x,setTotalAndTotalPage:O,setPage:B,renderPagination:T}=X({className:"mt-4",defaultPageSize:20,pageSizeList:[5,10,20,50,100,500]}),d=s.useMemo(()=>!l&&!i?null:l&&i?o[l][i]??[]:l?Object.values(o[l]).flat():Object.values(o).map(t=>t[i]).filter(Boolean).flat(),[l,i]),v=s.useCallback((t,r)=>{if(!g.current){if(d==null&&c==""){k([]),O(0),C({trucks_total:[],trucks_overall_total:0,onsite_trucks_total:{},onsite_per_station:{},onsite_trucks_overall_total:0});return}g.current=!0,U.get(route("dashboard.get",{date:h,capacity:u,logistics_unit:l,cluster:i,plate_no:m,page:t,page_size:r,location_codes:c==""?d??null:[c]})).then(a=>{k(a.data.data),O(a.data.total_data,r),C({trucks_total:a.data.trucks_total,trucks_overall_total:a.data.trucks_overall_total,onsite_trucks_total:a.data.onsite_trucks_total,onsite_per_station:a.data.onsite_per_station,onsite_trucks_overall_total:a.data.onsite_trucks_overall_total}),L(V())}).catch(a=>{console.log(a)}).finally(()=>{g.current=!1})}},[h,u,m,c,d]);s.useEffect(()=>{const t={current:null},r=()=>{t.current=setInterval(()=>{w(y=>-y)},S*1e3)},a=()=>{t.current&&(clearInterval(t.current),t.current=null)};r();const A=()=>{document.hidden?a():(w(y=>-y),r())};return document.addEventListener("visibilitychange",A),()=>{a(),document.removeEventListener("visibilitychange",A)}},[]),s.useEffect(()=>{B(0),v(0,x)},[h,u,c,d]),s.useEffect(()=>v(f,x),[z,f,x]);const K=t=>{t.key==="Enter"&&v(0,x)},Y=()=>{E(""),p(""),P(""),R(""),D(""),j("")},H=s.useCallback(()=>{document.location.href=route("dashboard.export",{date:h,capacity:u,logistics_unit:l,cluster:i,plate_no:m,page:f,page_size:x,location_codes:c==""?d??null:[c]})},[f,x]),V=()=>new Date().toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0}),W=t=>{j(""),E(t),p("")},q=t=>{j(""),p(t)},J=s.useMemo(()=>l?Object.keys(o[l]):Object.values(o).flatMap(t=>Object.keys(t)),[l]),Q=s.useMemo(()=>d?N.filter(t=>d.includes(t.code)):N,[d]);return e.jsxs("div",{className:"text-black bg-white",children:[e.jsxs("header",{className:"px-4 flex justify-between flex-wrap items-center gap-2 md:h-[60px] bg-gray-100",children:[e.jsx("img",{className:"w-[100px]",src:M,alt:""}),e.jsxs("div",{className:"flex gap-2 flex-wrap items-center",children:[e.jsxs("svg",{viewBox:"0 0 160 80",width:"100",height:"40",role:"img","aria-label":"Semi-trailer truck icon",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"g",x1:"0",x2:"1",children:[e.jsx("stop",{offset:"0",stopColor:"red"}),e.jsx("stop",{offset:"1",stopColor:"orange"})]})}),e.jsx("rect",{x:"6",y:"18",width:"96",height:"36",rx:"4",fill:"url(#g)"}),e.jsx("rect",{x:"106",y:"28",width:"40",height:"26",rx:"4",fill:"#1f6feb"}),e.jsx("rect",{x:"118",y:"20",width:"10",height:"10",rx:"2",fill:"#a7c4ff"}),e.jsx("rect",{x:"18",y:"26",width:"12",height:"20",rx:"1",fill:"#ffffff",opacity:"0.18"}),e.jsx("rect",{x:"36",y:"26",width:"12",height:"20",rx:"1",fill:"#ffffff",opacity:"0.12"}),e.jsxs("g",{fill:"#111",children:[e.jsx("circle",{cx:"30",cy:"62",r:"8"}),e.jsx("circle",{cx:"74",cy:"62",r:"8"}),e.jsx("circle",{cx:"126",cy:"62",r:"8"})]}),e.jsxs("g",{fill:"#e6e6e6",children:[e.jsx("circle",{cx:"30",cy:"62",r:"3"}),e.jsx("circle",{cx:"74",cy:"62",r:"3"}),e.jsx("circle",{cx:"126",cy:"62",r:"3"})]}),e.jsx("ellipse",{cx:"80",cy:"70",rx:"68",ry:"6",fill:"#000",opacity:"0.08"})]}),e.jsx("h1",{className:"text-[25px] font-bold",children:"Daily Truck RFID Tracker"})]}),e.jsxs("div",{children:["Last Refresh : ",F]})]}),e.jsxs("div",{className:"flex min-h-[calc(100vh-60px)] flex-wrap",children:[e.jsxs("aside",{className:"m-1 bg-gray-200 p-1 w-[200px]",children:[e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"font-bold",children:"Plate Number"}),e.jsx("input",{value:m,onChange:t=>P(t.target.value),onKeyUp:K,type:"text",className:"w-full rounded-[0.20rem] border-gray-300 text-sm text-gray-700",placeholder:"Search"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"font-bold",children:"Date"}),e.jsx("input",{value:h,onChange:t=>D(t.target.value),type:"date",className:"w-full py-1 rounded-[0.20rem] border-gray-300 text-sm text-gray-700"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"font-bold",children:"Logistics Unit"}),e.jsxs("select",{value:l,onChange:t=>W(t.target.value),className:"w-full py-1 rounded-[0.20rem] border-gray-300 text-sm text-gray-700",children:[e.jsx("option",{value:"",children:"All"}),Object.keys(o).map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"font-bold",children:"Cluster"}),e.jsxs("select",{value:i,onChange:t=>q(t.target.value),className:"w-full py-1 rounded-[0.20rem] border-gray-300 text-sm text-gray-700",children:[e.jsx("option",{value:"",children:"All"}),J.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"font-bold",children:"Site Name"}),e.jsxs("select",{value:c,onChange:t=>j(t.target.value),className:"w-full py-1 rounded-[0.20rem] border-gray-300 text-sm text-gray-700",children:[e.jsx("option",{value:"",children:"All"}),Q.map(t=>e.jsx("option",{value:t.code,children:t.name},t.code))]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"font-bold",children:"Pallet Capacity"}),e.jsxs("select",{value:u,onChange:t=>R(t.target.value),className:"w-full py-1 rounded-[0.20rem] border-gray-300 text-sm text-gray-700",children:[e.jsx("option",{value:"",children:"All"}),Array.from({length:50},(t,r)=>r+1).map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsx("button",{onClick:Y,className:"w-full mt-[1.5rem] py-2 border text-gray-800 rounded-[0.2rem] border-gray-500",children:"Reset"}),e.jsx("button",{onClick:H,className:"w-full mt-[10px] py-2 border text-gray-800 rounded-[0.2rem] border-gray-500",children:"Export"})]}),e.jsx("main",{className:"flex-1 mt-1 min-w-[300px] overflow-x-auto p-2 border rounded-sm",children:_.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("table",{id:"dashboard-table",children:[e.jsx("thead",{className:"bg-black text-white",children:e.jsxs("tr",{className:"text-[0.91rem]",children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Plate Number"}),e.jsx("th",{children:"Ownership"}),e.jsx("th",{children:"Location"}),e.jsx("th",{children:"Pallet Capacity"}),e.jsx("th",{children:"Truck Source"}),e.jsx("th",{children:"Station"}),e.jsx("th",{className:"min-w-[75px]",children:"In"}),e.jsx("th",{className:"min-w-[75px]",children:"Out"}),e.jsx("th",{children:"Duration"}),e.jsx("th",{children:"Entry"}),e.jsx("th",{children:"Parking"}),e.jsx("th",{children:"Dock"}),e.jsx("th",{children:"Yard"}),e.jsx("th",{children:"Exit"})]})}),e.jsx("tbody",{children:_.map((t,r)=>e.jsxs("tr",{className:"border-b text-sm text-gray-600 hover:bg-gray-200",children:[e.jsx("td",{className:"font-semibold text-black",children:t.date}),e.jsx("td",{children:t.plate_no}),e.jsx("td",{children:t.ownership}),e.jsx("td",{children:t.location}),e.jsx("td",{children:t.capacity}),e.jsx("td",{children:t.location_source}),e.jsx("td",{children:t.station}),e.jsx("td",{children:t.entry_error?e.jsx("p",{className:"p-1 rounded-sm bg-red-200 text-red-700",children:t.entry_error}):t.in}),e.jsx("td",{children:t.exit_error?e.jsx("p",{className:"p-1 rounded-sm bg-red-200 text-red-700",children:t.exit_error}):t.out??"-"}),e.jsx("td",{children:t.duration??"-"}),e.jsx("td",{}),e.jsx("td",{children:t.current_station=="Parking"&&e.jsx(b,{})}),e.jsx("td",{children:t.current_station=="Dock"&&e.jsx(b,{})}),e.jsx("td",{children:t.current_station=="Yard"&&e.jsx(b,{})}),e.jsx("td",{children:t.current_station=="Exit"&&e.jsx(b,{})})]},r))})]}),T]}):e.jsx("div",{className:"w-full h-full text-2xl font-bold flex justify-center items-center",children:"No data found."})}),e.jsxs("aside",{className:"m-1 bg-gray-200 w-[200px]",children:[e.jsx("h4",{className:"w-full font-bold bg-gray-300 text-center",children:"Announcement Board"}),e.jsxs("div",{className:"bg-blue-200 w-full p-1 h-[100px]",children:[e.jsxs("div",{className:"flex gap-2 font-bold text-sm border-b border-blue-400",children:[e.jsx("button",{className:"",children:"Site"}),e.jsx("button",{className:"",children:"Message"})]}),e.jsxs("div",{className:"flex gap-2 text-sm",children:[e.jsx("button",{className:"",children:c}),e.jsx("button",{className:"",children:"Work in Progress"})]})]}),e.jsx("h4",{className:"w-full font-bold bg-gray-300 text-center",children:"Fleet Inventory"}),e.jsxs("div",{className:"px-2",children:[e.jsxs("div",{className:"flex gap-2 justify-between font-bold text-sm border-b border-blue-400",children:[e.jsx("div",{className:"",children:"Owner"}),e.jsx("div",{className:"",children:"# of Trucks"})]}),n.trucks_total.map((t,r)=>e.jsxs("div",{className:"flex gap-2 justify-between text-gray-600 text-sm border-b border-blue-400",children:[e.jsx("div",{className:"",children:t.provider}),e.jsx("div",{className:"",children:t.total})]},r)),e.jsxs("div",{className:"flex gap-2 justify-between text-sm font-bold",children:[e.jsx("div",{className:"",children:"Total"}),e.jsx("div",{className:"",children:n.trucks_overall_total})]})]}),e.jsx("h4",{className:"w-full mt-10 font-bold bg-gray-300 text-center",children:"On-site Trucks"}),e.jsxs("div",{className:"px-2 pb-1",children:[e.jsxs("div",{className:"flex gap-2 justify-between font-bold text-sm border-b border-blue-400",children:[e.jsx("div",{className:"",children:"Owner"}),e.jsx("div",{className:"",children:"# of Trucks"})]}),Object.keys(n.onsite_trucks_total).map(t=>e.jsxs("div",{className:"flex gap-2 justify-between text-gray-600 text-sm border-b border-blue-400",children:[e.jsx("div",{className:"",children:t}),e.jsx("div",{className:"",children:n.onsite_trucks_total[t]})]},t)),e.jsxs("div",{className:"flex gap-2 justify-between text-sm font-bold",children:[e.jsx("div",{className:"",children:"Total"}),e.jsx("div",{className:"",children:n.onsite_trucks_overall_total})]})]}),e.jsx("h4",{className:"w-full mt-10 font-bold bg-gray-300 text-center",children:"On-site Trucks Per Station"}),e.jsxs("div",{className:"px-2 pb-3",children:[e.jsxs("div",{className:"flex gap-2 justify-between font-bold text-sm border-b border-blue-400",children:[e.jsx("div",{className:"",children:"Station"}),e.jsx("div",{className:"",children:"# of Trucks"})]}),Object.keys(n.onsite_per_station).map(t=>e.jsxs("div",{className:"flex gap-2 justify-between text-gray-600 text-sm border-b border-blue-400",children:[e.jsx("div",{className:"",children:t}),e.jsx("div",{className:"",children:n.onsite_per_station[t]})]},t)),e.jsxs("div",{className:"flex gap-2 justify-between text-sm font-bold",children:[e.jsx("div",{className:"",children:"Total"}),e.jsx("div",{className:"",children:n.onsite_trucks_overall_total})]})]})]})]})]})}export{G as default};
